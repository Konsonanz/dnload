static const char *g_shader_fragment_quad = ""
#if defined(USE_LD)
"quad_430.frag.glsl"
#else
"#version 430\n"
"layout(location=0)uniform vec3[4] e;"
"in vec2 o;"
"out vec4 n;"
"void main()"
"{"
"vec2 e=o;"
"if(e[3].g>1.)"
"{"
"e.r*=e[3].g;"
"}"
"else"
"{"
"e.g/=e[3].g;"
"}"
"vec3 o=normalize(e[1]),n=normalize(cross(o,e[2])),i=normalize(e.r*n+e.g*normalize(cross(n,o))+o);"
"float r=dot(-e[0],i),v=1.+sin(e[3].r/4444.)*.1;"
"vec3 t=r*i+e[0];"
"float c=dot(t,t);"
"if(c<=v)"
"{"
"vec3 e=(r-sqrt(v*v-c*c))*i+e[0];"
"n=vec4(e*dot(e,vec3(1.)),1.);"
"}"
"else"
"{"
"n=vec4(.0,.0,.0,1.);"
"}"
"}"
#endif
"";
